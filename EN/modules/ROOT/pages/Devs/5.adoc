:sectnums:
:sectnumlevels: 5

:imagesdir: ./_images

= Dual-mode design

== Objective

- In order to meet the PG mode and the compatible Oracle mode, IVORYSQL designed two modes: PG and Oracle. And the schema can be specified at initdb time.

== Scheme

- Compatibility with Oracle mode is divided into three steps:

 1、The relevant files for generating Oracle mode are shown in the figure:

image::p8.png[]

 2、Initdb -m initialization requires judgment of different modes, among which oracle mode requires the execution of SQL statements postgres_oracle.bki. The default is Oracle compatibility mode, and the process is as follows:
 
image::p9.png[]

 3、Startup: When starting, it determines whether it is an Oracle compatibility mode based on the initialization mode.

```
Description:
database_mode: Used to indicate initialization mode;
database_mode=DB_PG，PG mode, and cannot be switched;
database_mode=DB_ORACLE， oracle compatibility mode;
```

